<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle de FrequÃªncia - EBD</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- PÃ¡gina de SeleÃ§Ã£o de Classes -->
  <div id="pagina-selecao">
    <header>
      <h1>Escola Dominical - Controle de FrequÃªncia</h1>
      <h2>Selecione sua classe</h2>
    </header>

    <div class="classes-grid">
      <div class="classe-card" data-classe="Jovens por Cristo">
        <h2>Jovens por Cristo</h2>
        <p>Classe de jovens</p>
      </div>
      
      <div class="classe-card" data-classe="Evangelista">
        <h2>Evangelista</h2>
        <p>Classe de adolescentes
      </div>
      
      <div class="classe-card" data-classe="Daniel">
        <h2>Daniel</h2>
        <p>Classe masculina</p>
      </div>
      
      <div class="classe-card" data-classe="Noemi">
        <h2>Noemi</h2>
        <p>Classe feminina</p>
      </div>
    </div>

    <footer>
      <p>&copy; 2025 EBD Vila Carolina</p>
    </footer>
  </div>

  <!-- Aplicativo Principal (inicialmente oculto) -->
  <div id="pagina-app" style="display: none;">
    <header>
      <h1>4Âº Trimestre - Escola Dominical</h1>
      <p id="nomeClasse">Carregando...</p>
      <p id="dataAtual"></p>
      <a href="#" id="btnVoltar" style="color: #feffcc; text-decoration: none;">â† Voltar para seleÃ§Ã£o de classes</a>
    </header>

    <main>
      <form id="frequenciaForm">
        <table>
          <thead>
            <tr>
              <th>Nome</th>
              <th>PresenÃ§a</th>
            </tr>
          </thead>
          <tbody id="tabelaAlunos"></tbody>
        </table>
      </form>
      
      <section id="secao-visitantes">
        <h2>Visitantes</h2>
        <form id="form-visitante">
          <input type="text" id="nomeVisitante" placeholder="Nome do visitante" required>
          <button type="submit" id="btnIncluir">Incluir</button>
        </form>
        <div id="lista-visitantes"></div>
      </section>

      <section id="resumo">
        <h2>Resumo da Classe</h2>

        <div class="campo">
          <label for="totalMatriculados">Total Matriculados:</label>
          <input type="number" id="totalMatriculados" readonly>
        </div>

        <div class="campo">
          <label for="presentes">Presentes:</label>
          <input type="number" id="presentes" readonly>
        </div>

        <div class="campo">
          <label for="visitantes">Visitantes:</label>
          <input type="number" id="visitantes" readonly value="0">
        </div>

        <div class="campo">
          <label for="revistas">Revistas:</label>
          <input type="number" id="revistas" value="0" min="0">
        </div>

        <div class="campo">
          <label for="biblias">BÃ­blias:</label>
          <input type="number" id="biblias" value="0" min="0">
        </div>

        <div class="campo">
          <label for="oferta">Oferta (R$):</label>
          <input type="number" id="oferta" step="0.01" value="0.00" min="0">
        </div>
      </section>
      
      <div id="acoes">
        <button id="btnExportar">Enviar RelatÃ³rio para secretaria</button>
      </div>
    </main>

    <footer>
      <p>&copy; 2025 EBD Vila Carolina</p>
    </footer>
  </div>

  <!-- Modal de ConfirmaÃ§Ã£o -->
  <div id="modalConfirmacao" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <div class="modal-icon">âœ…</div>
      <h2>RelatÃ³rio Gerado!</h2>
      
      <div id="conteudo-android" class="dispositivo-conteudo">
        <p>ğŸ“ <strong>Arquivo Excel baixado!</strong></p>
        <p>Agora compartilhe pelo WhatsApp com a secretaria.</p>
      </div>
      
      <div id="conteudo-ios" class="dispositivo-conteudo">
        <p>ğŸ“ <strong>Arquivo pronto para compartilhar!</strong></p>
        <button id="btnCompartilharIOS" class="btn-whatsapp">
          ğŸ“¤ Compartilhar Arquivo
        </button>
      </div>
      
      <div id="conteudo-fallback" class="dispositivo-conteudo">
        <p>ğŸ“Š <strong>RelatÃ³rio gerado com sucesso!</strong></p>
        <button id="btnDownloadManual" class="btn-whatsapp">
          â¬‡ï¸ Fazer Download
        </button>
      </div>

      <div class="modal-botoes">
        <button id="btnFecharModal" class="btn-sucesso">Fechar e Limpar</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>